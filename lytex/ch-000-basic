#!/usr/bin/nodejs

require( 'local/settings' );
var ScaleGenerator = require( 'local/chromatic/formatter' );

var THE_TEXT = 
`
\\paper  {
    #(set! paper-alist (cons '("a4insides" . (cons (* 5 in) (* 3 in))) paper-alist))
    #(set-paper-size "a4insides")
}
`;

ScaleGenerator.prototype.writeScore2 = function ( type, notes ) {
	var id = notes.split( /\s+/ ).shift();
	var output = ScaleGenerator.applyTemplate( notes, null,null, this.settings );

	output = output + "\n" + THE_TEXT + "\n";

	this.nextOutputFilename( type + '-' + id );
	ScaleGenerator.writeFile( this.currentOutputFilename(), output );

	this.writeIncludeText( '\\noindent $\\vcenter{ \\hbox{ \\includegraphics[width=0.6 \\textwidth]{' + this.currentOutputFilenameAsPDF() + '}}}$\n' );
};

var OUTPUT_PATH = 'out/'
function batch() {
	var c = new ScaleGenerator( OUTPUT_PATH /*, 'basic' */ );

	c.writeHeader0( "Basics" );
	c.writeTextBody( 'Welcome to the world of chromatic solfège.' );

	c.writeHeader1( "Natural" );
	c.writeTextBody( 'The diatonic notes are named as the traditional solfège.' );
	c.writeScore2( "example", "do  do  re mi fa sol la ti do" );

	c.writeHeader1( "Flat" );
	c.writeTextBody( 'When flat is added to a note, the name of the note alters. The vowel part of the name will be replaced to “\\textit{e}”. In case the vowel is already “\\textit{e}”, it will be replaced with “\\textit{a}”.' );
	c.writeScore2( "example", "do  de  ra me fe se  le te de" );

	c.writeHeader1( "Sharp" );
	c.writeTextBody( 'Sharp is treated in the same manner except it will be replaced with “i”. In case the vowel is already “i”, it will be replaced with “a” as well as flat.' );
	c.writeScore2( "example", "do  di  ri mi fi si  li ta di" );

	c.writeHeader1( "Double Flat" );
	c.writeTextBody( 'Double flat is also treated in the same manner as flat and sharp, except the vowel is replaced with “aw”.' );
	c.writeScore2( "example", "do  daw raw maw faw saw law taw daw" );

	c.writeHeader1( "Double Sharp" );
	c.writeTextBody( 'Double sharp is also treated in the same manner as double flat, except the vowel is replaced with “ai”.' );
	c.writeScore2( "example", "do  dai rai mai fai sai lai tai dai" );

	c.writeHeader1( "Triple Flat" );
	c.writeTextBody( 'Notes with triple flat are called similarily with notes with double flats, except their names end with “f”.' );
	c.writeScore2( "example", "do  dae  rae mae fae sae lae tae dae" );

	c.writeHeader1( "Triple Sharp" );
	c.writeTextBody( 'Notes with triple sharp are called similarily with notes with double sharp, except their names end with “f”.' );
	c.writeScore2( "example", "do  dao  rao mao fao sao lao tao dao" );


	// c.writeScore2( "diatonic", "do  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeHeader1( "Sharp" );
	// c.writeScore2( "diatonic", "sol do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "re  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "la  do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "mi  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "ti  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "fi  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeHeader1( "Flat" );
	// c.writeScore2( "diatonic", "fa  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "te  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "me  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "le  do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "re  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "se  do' re mi fa sol la ti do | do ti la sol fa mi re do" );

	// c.writeHeader1( "Special ( Flat )" );
	// c.writeScore2( "diatonic", "de  do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "fe  do' re mi fa sol la ti do | do ti la sol fa mi re do" );

	// c.writeHeader1( "Special ( Sharp )" );
	// c.writeScore2( "diatonic", "di  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "si  do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "ri  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "li  do' re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "ma  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	// c.writeScore2( "diatonic", "ta  do  re mi fa sol la ti do | do ti la sol fa mi re do" );
	c.close();
}

batch();




// vim: filetype=javascript :

