function createTemplate( arr, sourceFilename, templateFilename ) {
	var result = "";
	if ( ! templateFilename ) 
		templateFilename = "chromatic-solfege-gen.ly";

result += `
\\version "2.18.2"
\\include "aaron.ly"
\\include "${templateFilename}"
\\include "lilypond-book-preamble.ly"
\\language "aaron"

source-filename = "${sourceFilename}"

`;

	function createBlock( caption, notes, lyrics ) {
		var result =  "";
		if ( caption ) {
			result +=
(`
\\markup \\bold \\italic {
    ${caption}
}
`);
		}

		result +=
`
\\makescore 
  \\relative do' {
    ${notes}
  }
  \\lyricmode {
    ${lyrics}
  }
`;
		return result;
	}

	for ( var i=0; i<arr.length; i++ ) {
		var e= arr[i];
		result += createBlock( e.caption, e.notes, e.lyrics );
	}
	return result.trim();
}

if ( module && module.exports ) {
	module.exports = createTemplate;
}
